# Puppet Infrastructure Summary: Found a Monolithic Infrastructure with Compilers

Warning: Undefined variable 'spacetest';
   (file & line not available)
# Found 8 CPU(s) / 15884 MB RAM for Primary Master pm201987.platform9.puppet.net
# Specify the following optimized settings in Hiera in nodes/pm201987.platform9.puppet.net.yaml

---
puppet_enterprise::profile::database::shared_buffers: 3176MB
puppet_enterprise::puppetdb::command_processing_threads: 4
puppet_enterprise::profile::puppetdb::java_args:
  Xms: 2382m
  Xmx: 2382m
puppet_enterprise::profile::orchestrator::jruby_max_active_instances: 2
puppet_enterprise::profile::orchestrator::java_args:
  Xms: 1588m
  Xmx: 1588m
puppet_enterprise::profile::console::java_args:
  Xms: 1024m
  Xmx: 1024m
puppet_enterprise::master::puppetserver::jruby_max_active_instances: 3
puppet_enterprise::profile::master::java_args:
  Xms: 2304m
  Xmx: 2304m
puppet_enterprise::master::puppetserver::reserved_code_cache: 288m
puppet_infrastructure_tune::metadata:
  pe_version: 2019.8.7
  tune_date: '2021-07-30'

# CPU Summary: Total/Used/Free: 8/7/1 for pm201987.platform9.puppet.net
# RAM Summary: Total/Used/Free: 15884/10762/5122 for pm201987.platform9.puppet.net
# JVM Summary: Using 768 MB per Puppet Server JRuby for pm201987.platform9.puppet.net

puppet_metrics_collector::puppetserver_hosts:
  -'pm201987.platform9.puppet.net.yaml'
  -'cm201987.platform9.puppet.net.yaml'
  -'rep201987.platform9.puppet.net.yaml'
puppet_metrics_collector::puppetdb_hosts:
  -'pm201987.platform9.puppet.net.yaml'

node 'pm201987.platform9.puppet.net'{
  includepuppet_metrics_dashboard::profile::master::install
  includepuppet_metrics_dashboard::profile::master::postgres_access
}
node 'dashboard.example.com'{
  class{ 'puppet_metrics_dashboard':
    add_dashboard_examples => true,
    overwrite_dashboards   => false,
  }
}

node 'master.example.com' {
  include puppet_metrics_dashboard::profile::master::install
}
node 'dbcompiler.example.com' {
  class { 'puppet_metrics_dashboard::profile::dbcompiler::install':
    influxdb_urls => ["http://dashboard.example.com:8086"]
  }
}

node 'dashboard.example.com' {
  class { 'puppet_metrics_dashboard':
    add_dashboard_examples => true,
    overwrite_dashboards   => false,
    configure_telegraf     => true,
    enable_telegraf        => true,
    consume_graphite       => true,
    influxdb_database_name => ['telegraf', 'graphite', 'puppet_metrics'],
    master_list            => ['pm201987.platform9.puppet.net', 'cm201987.platform9.puppet.net'],
  }
}



